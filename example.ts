import { fromStreamReader } from "https://deno.land/std@0.73.0/io/mod.ts";
import { GauGan } from "./mod.ts";

async function ganImageToFile(filePath: string, imageBase64: string) {
  const guangan = new GauGan();

  const res = await guangan.transformImage(imageBase64);

  const streamReader = res.body?.getReader();

  if (streamReader) {
    const reader = fromStreamReader(streamReader);
    await Deno.create(filePath);
    const file = await Deno.open(filePath, { write: true });
    await Deno.copy(reader, file);
    file.close();
  } else {
    throw new Error("Could not get reader of the result.");
  }
}

ganImageToFile(
  "./out.jpg",
  "data:image/png;base64,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gCdY+kB3CgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALKQAAMBCCgAALPS/e765ThIxUL0AAAAASUVORK5CYII=",
);
